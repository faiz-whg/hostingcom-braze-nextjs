"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_node_modules_braze_web-sdk_src_Push_push-manager-factory_js"],{

/***/ "(app-pages-browser)/./node_modules/@braze/web-sdk/shared-lib/encoding-utils.js":
/*!******************************************************************!*\
  !*** ./node_modules/@braze/web-sdk/shared-lib/encoding-utils.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst ei = {\n  Vn: function (t) {\n    const r = (t + \"=\".repeat((4 - (t.length % 4)) % 4))\n        .replace(/\\-/g, \"+\")\n        .replace(/_/g, \"/\"),\n      n = atob(r),\n      o = new Uint8Array(n.length);\n    for (let t = 0; t < n.length; ++t) o[t] = n.charCodeAt(t);\n    return o;\n  },\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ei);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYnJhemUvd2ViLXNkay9zaGFyZWQtbGliL2VuY29kaW5nLXV0aWxzLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixjQUFjO0FBQ2xDO0FBQ0EsR0FBRztBQUNIO0FBQ0EsaUVBQWUsRUFBRSxFQUFDIiwic291cmNlcyI6WyIvVXNlcnMvZmFpenVyL2hvc3Rpbmdjb20tYnJhemUtbmV4dGpzL25vZGVfbW9kdWxlcy9AYnJhemUvd2ViLXNkay9zaGFyZWQtbGliL2VuY29kaW5nLXV0aWxzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGVpID0ge1xuICBWbjogZnVuY3Rpb24gKHQpIHtcbiAgICBjb25zdCByID0gKHQgKyBcIj1cIi5yZXBlYXQoKDQgLSAodC5sZW5ndGggJSA0KSkgJSA0KSlcbiAgICAgICAgLnJlcGxhY2UoL1xcLS9nLCBcIitcIilcbiAgICAgICAgLnJlcGxhY2UoL18vZywgXCIvXCIpLFxuICAgICAgbiA9IGF0b2IociksXG4gICAgICBvID0gbmV3IFVpbnQ4QXJyYXkobi5sZW5ndGgpO1xuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgbi5sZW5ndGg7ICsrdCkgb1t0XSA9IG4uY2hhckNvZGVBdCh0KTtcbiAgICByZXR1cm4gbztcbiAgfSxcbn07XG5leHBvcnQgZGVmYXVsdCBlaTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@braze/web-sdk/shared-lib/encoding-utils.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@braze/web-sdk/src/Push/push-manager-factory.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@braze/web-sdk/src/Push/push-manager-factory.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../managers/braze-instance.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/src/managers/braze-instance.js\");\n/* harmony import */ var _push_manager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./push-manager.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/src/Push/push-manager.js\");\n\n\nconst ra = {\n  l: !1,\n  aa: null,\n  ea: () => (\n    ra.p(),\n    ra.aa ||\n      (ra.aa = new _push_manager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].mr(),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].Ma(),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].ue(),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].Z(),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].ee(_managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__.OPTIONS._a),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].ee(_managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__.OPTIONS.Aa),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].ee(_managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__.OPTIONS.Ba),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].v(),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].ee(_managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__.OPTIONS.Ca),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].ee(_managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__.OPTIONS.Da),\n        _managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].j(),\n      )),\n    ra.aa\n  ),\n  p: () => {\n    ra.l || (_managers_braze_instance_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].h(ra), (ra.l = !0));\n  },\n  destroy: () => {\n    (ra.aa = null), (ra.l = !1);\n  },\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ra);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYnJhemUvd2ViLXNkay9zcmMvUHVzaC9wdXNoLW1hbmFnZXItZmFjdG9yeS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0U7QUFDN0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHdEQUFFO0FBQ3JCLFFBQVEsbUVBQUM7QUFDVCxRQUFRLG1FQUFDO0FBQ1QsUUFBUSxtRUFBQztBQUNULFFBQVEsbUVBQUM7QUFDVCxRQUFRLG1FQUFDLElBQUksZ0VBQUM7QUFDZCxRQUFRLG1FQUFDLElBQUksZ0VBQUM7QUFDZCxRQUFRLG1FQUFDLElBQUksZ0VBQUM7QUFDZCxRQUFRLG1FQUFDO0FBQ1QsUUFBUSxtRUFBQyxJQUFJLGdFQUFDO0FBQ2QsUUFBUSxtRUFBQyxJQUFJLGdFQUFDO0FBQ2QsUUFBUSxtRUFBQztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxtRUFBQztBQUNkLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsaUVBQWUsRUFBRSxFQUFDIiwic291cmNlcyI6WyIvVXNlcnMvZmFpenVyL2hvc3Rpbmdjb20tYnJhemUtbmV4dGpzL25vZGVfbW9kdWxlcy9AYnJhemUvd2ViLXNkay9zcmMvUHVzaC9wdXNoLW1hbmFnZXItZmFjdG9yeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgciwgeyBPUFRJT05TIGFzIHcgfSBmcm9tIFwiLi4vbWFuYWdlcnMvYnJhemUtaW5zdGFuY2UuanNcIjtcbmltcG9ydCBuYSBmcm9tIFwiLi9wdXNoLW1hbmFnZXIuanNcIjtcbmNvbnN0IHJhID0ge1xuICBsOiAhMSxcbiAgYWE6IG51bGwsXG4gIGVhOiAoKSA9PiAoXG4gICAgcmEucCgpLFxuICAgIHJhLmFhIHx8XG4gICAgICAocmEuYWEgPSBuZXcgbmEoXG4gICAgICAgIHIubXIoKSxcbiAgICAgICAgci5NYSgpLFxuICAgICAgICByLnVlKCksXG4gICAgICAgIHIuWigpLFxuICAgICAgICByLmVlKHcuX2EpLFxuICAgICAgICByLmVlKHcuQWEpLFxuICAgICAgICByLmVlKHcuQmEpLFxuICAgICAgICByLnYoKSxcbiAgICAgICAgci5lZSh3LkNhKSxcbiAgICAgICAgci5lZSh3LkRhKSxcbiAgICAgICAgci5qKCksXG4gICAgICApKSxcbiAgICByYS5hYVxuICApLFxuICBwOiAoKSA9PiB7XG4gICAgcmEubCB8fCAoci5oKHJhKSwgKHJhLmwgPSAhMCkpO1xuICB9LFxuICBkZXN0cm95OiAoKSA9PiB7XG4gICAgKHJhLmFhID0gbnVsbCksIChyYS5sID0gITEpO1xuICB9LFxufTtcbmV4cG9ydCBkZWZhdWx0IHJhO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@braze/web-sdk/src/Push/push-manager-factory.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@braze/web-sdk/src/Push/push-manager.js":
/*!**************************************************************!*\
  !*** ./node_modules/@braze/web-sdk/src/Push/push-manager.js ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ na)\n/* harmony export */ });\n/* harmony import */ var _util_code_utils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../util/code-utils.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/src/util/code-utils.js\");\n/* harmony import */ var _models_push_token_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../models/push-token.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/src/models/push-token.js\");\n/* harmony import */ var _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared-lib/index.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/shared-lib/logger.js\");\n/* harmony import */ var _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared-lib/index.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/shared-lib/encoding-utils.js\");\n/* harmony import */ var _managers_storage_manager_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../managers/storage-manager.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/src/managers/storage-manager.js\");\n/* harmony import */ var _User_index_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../User/index.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/src/User/user.js\");\n/* harmony import */ var _utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/push-utils.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/src/Push/utils/push-utils.js\");\n/* harmony import */ var _util_error_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/error-utils.js */ \"(app-pages-browser)/./node_modules/@braze/web-sdk/src/util/error-utils.js\");\n\n\n\n\n\n\n\nclass na {\n  constructor(i, t, e, s, r, n, o, u, a, h, c) {\n    (this.on = i),\n      (this.un = t),\n      (this.an = e),\n      (this.hn = r),\n      (this.cn = n),\n      (this.fn = o),\n      (this.B = u),\n      (this.ln = a),\n      (this.dn = h),\n      (this.C = c),\n      (this.on = i),\n      (this.un = t),\n      (this.an = e),\n      (this.pn = s + \"/safari/\" + t),\n      (this.hn = r || \"/service-worker.js\"),\n      (this.fn = o),\n      (this.B = u),\n      (this.ln = a || !1),\n      (this.dn = h || !1),\n      (this.C = c),\n      (this.bn = _utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].yn()),\n      (this.mn = _utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].gn());\n  }\n  vn() {\n    return this.dn;\n  }\n  wn(i, t, e, s, r) {\n    i.unsubscribe()\n      .then((i) => {\n        i\n          ? this.kn(t, e, s, r)\n          : (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\"Failed to unsubscribe device from push.\"),\n            \"function\" == typeof r && r(!1));\n      })\n      .catch((i) => {\n        _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\"Push unsubscription error: \" + i),\n          \"function\" == typeof r && r(!1);\n      });\n  }\n  Pn(i, t, e) {\n    var s;\n    const r = ((i) => {\n      if (\"string\" == typeof i) return i;\n      if (0 !== i.endpoint.indexOf(\"https://android.googleapis.com/gcm/send\"))\n        return i.endpoint;\n      let t = i.endpoint;\n      const e = i;\n      return (\n        e.Dn &&\n          -1 === i.endpoint.indexOf(e.Dn) &&\n          (t = i.endpoint + \"/\" + e.Dn),\n        t\n      );\n    })(i);\n    let n = null,\n      o = null;\n    const u = i;\n    if (null != u.getKey)\n      try {\n        const i = Array.from(new Uint8Array(u.getKey(\"p256dh\"))),\n          t = Array.from(new Uint8Array(u.getKey(\"auth\")));\n        (n = btoa(String.fromCharCode.apply(null, i))),\n          (o = btoa(String.fromCharCode.apply(null, t)));\n      } catch (i) {\n        _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error((0,_util_error_utils_js__WEBPACK_IMPORTED_MODULE_2__.getErrorMessage)(i));\n      }\n    const a = ((i) => {\n      let t;\n      return i.options &&\n        (t = i.options.applicationServerKey) &&\n        t.byteLength &&\n        t.byteLength > 0\n        ? btoa(String.fromCharCode.apply(null, Array.from(new Uint8Array(t))))\n            .replace(/\\+/g, \"-\")\n            .replace(/\\//g, \"_\")\n        : null;\n    })(u);\n    null === (s = this.on) || void 0 === s || s.Sn(r, t, n, o, a),\n      r && \"function\" == typeof e && e(r, n, o);\n  }\n  An() {\n    var i;\n    null === (i = this.on) || void 0 === i || i.jn(!0);\n  }\n  xn(i, t) {\n    var e;\n    null === (e = this.on) || void 0 === e || e.jn(!1),\n      _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(i),\n      \"function\" == typeof t && t(!1);\n  }\n  Nn(i, t, e, s) {\n    var r;\n    if (\"default\" === t.permission)\n      try {\n        window.safari.pushNotification.requestPermission(\n          this.pn,\n          i,\n          {\n            api_key: this.un,\n            device_id:\n              (null === (r = this.an) || void 0 === r ? void 0 : r.ve().id) ||\n              \"\",\n          },\n          (t) => {\n            \"granted\" === t.permission &&\n              this.on &&\n              this.on.setPushNotificationSubscriptionType(\n                _User_index_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].NotificationSubscriptionTypes.OPTED_IN,\n              ),\n              this.Nn(i, t, e, s);\n          },\n        );\n      } catch (i) {\n        this.xn(\"Could not request permission for push: \" + i, s);\n      }\n    else\n      \"denied\" === t.permission\n        ? this.xn(\n            \"The user has blocked notifications from this site, or Safari push is not configured in the Braze dashboard.\",\n            s,\n          )\n        : \"granted\" === t.permission &&\n          (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"Device successfully subscribed to push.\"),\n          this.Pn(t.deviceToken, new Date(), e));\n  }\n  requestPermission(i, t, e) {\n    const s = (s) => {\n      switch (s) {\n        case \"granted\":\n          return void (\"function\" == typeof i && i());\n        case \"default\":\n          return void (\"function\" == typeof t && t());\n        case \"denied\":\n          return void (\"function\" == typeof e && e());\n        default:\n          _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\"Received unexpected permission result \" + s);\n      }\n    };\n    let r = !1;\n    if (\"default\" !== window.Notification.permission)\n      s(Notification.permission);\n    else {\n      const i = window.Notification.requestPermission((i) => {\n        r && s(i);\n      });\n      i\n        ? i.then((i) => {\n            s(i);\n          })\n        : (r = !0);\n    }\n  }\n  kn(i, t, e, s) {\n    const r = { userVisibleOnly: !0 };\n    null != t && (r.applicationServerKey = t),\n      i.pushManager\n        .subscribe(r)\n        .then((i) => {\n          _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"Device successfully subscribed to push.\"),\n            this.Pn(i, new Date(), e);\n        })\n        .catch((i) => {\n          _utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isPushBlocked()\n            ? (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"Permission for push notifications was denied.\"),\n              \"function\" == typeof s && s(!1))\n            : (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\"Push subscription failed: \" + i),\n              \"function\" == typeof s && s(!0));\n        });\n  }\n  Un() {\n    if (this.ln) return navigator.serviceWorker.getRegistration(this.hn);\n    const i = this.cn ? { scope: this.cn } : void 0;\n    return navigator.serviceWorker.register(this.hn, i).then(() =>\n      navigator.serviceWorker.ready.then(\n        (i) => (\n          i &&\n            \"function\" == typeof i.update &&\n            i.update().catch((i) => {\n              _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"ServiceWorker update failed: \" + i);\n            }),\n          i\n        ),\n      ),\n    );\n  }\n  Wn(i) {\n    this.ln ||\n      (i.unregister(), _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"Service worker successfully unregistered.\"));\n  }\n  subscribe(i, t) {\n    if (!_utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isPushSupported())\n      return _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(na._n), void (\"function\" == typeof t && t(!1));\n    if (this.bn) {\n      if (!this.ln && null != window.location) {\n        let i = this.hn;\n        -1 === i.indexOf(window.location.host) &&\n          (i = window.location.host + i),\n          -1 === i.indexOf(window.location.protocol) &&\n            (i = window.location.protocol + \"//\" + i);\n      }\n      if (_utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isPushBlocked())\n        return void this.xn(\n          \"Notifications from this site are blocked. This may be a temporary embargo or a permanent denial.\",\n          t,\n        );\n      if (this.B && !this.B.Tn() && 0 === this.B.Et())\n        return (\n          _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\n            \"Waiting for VAPID key from server config before subscribing to push.\",\n          ),\n          void this.B.In(() => {\n            this.subscribe(i, t);\n          })\n        );\n      const e = () => {\n          _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"Permission for push notifications was denied.\"),\n            \"function\" == typeof t && t(!1);\n        },\n        r = () => {\n          let i = \"Permission for push notifications was ignored.\";\n          _utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isPushBlocked() &&\n            (i +=\n              \" The browser has automatically blocked further permission requests for a period (probably 1 week).\"),\n            _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(i),\n            \"function\" == typeof t && t(!0);\n        },\n        n = _utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isPushPermissionGranted(),\n        o = () => {\n          !n &&\n            this.on &&\n            this.on.setPushNotificationSubscriptionType(\n              _User_index_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].NotificationSubscriptionTypes.OPTED_IN,\n            ),\n            this.Un()\n              .then((e) => {\n                if (null == e)\n                  return (\n                    _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\n                      \"No service worker registration. Set the `manageServiceWorkerExternally` initialization option to false or ensure that your service worker is registered before calling registerPush.\",\n                    ),\n                    void (\"function\" == typeof t && t(!0))\n                  );\n                e.pushManager\n                  .getSubscription()\n                  .then((r) => {\n                    var n;\n                    let o = null;\n                    if (\n                      (null !=\n                        (null === (n = this.B) || void 0 === n\n                          ? void 0\n                          : n.Tn()) && (o = _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].Vn(this.B.Tn())),\n                      r)\n                    ) {\n                      let n,\n                        u = null,\n                        a = null;\n                      if ((this.C && (n = this.C.ft(_managers_storage_manager_js__WEBPACK_IMPORTED_MODULE_5__.STORAGE_KEYS.gt.qn)), n && !(0,_util_code_utils_js__WEBPACK_IMPORTED_MODULE_6__.isArray)(n))) {\n                        let i;\n                        try {\n                          i = _models_push_token_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"].En(n).zn;\n                        } catch (t) {\n                          i = null;\n                        }\n                        null == i ||\n                          isNaN(i.getTime()) ||\n                          0 === i.getTime() ||\n                          ((u = i),\n                          (a = new Date(u)),\n                          a.setMonth(u.getMonth() + 6));\n                      }\n                      null != o &&\n                      r.options &&\n                      r.options.applicationServerKey &&\n                      r.options.applicationServerKey.byteLength &&\n                      r.options.applicationServerKey.byteLength > 0 &&\n                      !(0,_util_code_utils_js__WEBPACK_IMPORTED_MODULE_6__.isEqual)(o, new Uint8Array(r.options.applicationServerKey))\n                        ? (r.options.applicationServerKey.byteLength > 12\n                            ? _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\n                                \"Device was already subscribed to push using a different VAPID provider, creating new subscription.\",\n                              )\n                            : _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\n                                \"Attempting to upgrade a gcm_sender_id-based push registration to VAPID - depending on the browser this may or may not result in the same gcm_sender_id-based subscription.\",\n                              ),\n                          this.wn(r, e, o, i, t))\n                        : r.expirationTime &&\n                          new Date(r.expirationTime).valueOf() <=\n                            new Date().valueOf()\n                        ? (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\n                            \"Push subscription is expired, creating new subscription.\",\n                          ),\n                          this.wn(r, e, o, i, t))\n                        : n && (0,_util_code_utils_js__WEBPACK_IMPORTED_MODULE_6__.isArray)(n)\n                        ? this.wn(r, e, o, i, t)\n                        : null == a\n                        ? (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\n                            \"No push subscription creation date found, creating new subscription.\",\n                          ),\n                          this.wn(r, e, o, i, t))\n                        : a.valueOf() <= new Date().valueOf()\n                        ? (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\n                            \"Push subscription older than 6 months, creating new subscription.\",\n                          ),\n                          this.wn(r, e, o, i, t))\n                        : (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\n                            \"Device already subscribed to push, sending existing subscription to backend.\",\n                          ),\n                          this.Pn(r, u, i));\n                    } else this.kn(e, o, i, t);\n                  })\n                  .catch((i) => {\n                    _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\"Error checking current push subscriptions: \" + i);\n                  });\n              })\n              .catch((i) => {\n                _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\"ServiceWorker registration failed: \" + i);\n              });\n        };\n      this.requestPermission(o, r, e);\n    } else if (this.mn) {\n      if (null == this.fn || \"\" === this.fn)\n        return (\n          _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\n            \"You must supply the safariWebsitePushId initialization option in order to use registerPush on Safari\",\n          ),\n          void (\"function\" == typeof t && t(!0))\n        );\n      const e = window.safari.pushNotification.permission(this.fn);\n      this.Nn(this.fn, e, i, t);\n    }\n  }\n  unsubscribe(i, t) {\n    if (!_utils_push_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isPushSupported())\n      return _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(na._n), void (\"function\" == typeof t && t());\n    this.bn\n      ? navigator.serviceWorker.getRegistration(this.hn).then((e) => {\n          e\n            ? e.pushManager\n                .getSubscription()\n                .then((s) => {\n                  s\n                    ? (this.An(),\n                      s\n                        .unsubscribe()\n                        .then((s) => {\n                          s\n                            ? (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\n                                \"Device successfully unsubscribed from push.\",\n                              ),\n                              \"function\" == typeof i && i())\n                            : (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\n                                \"Failed to unsubscribe device from push.\",\n                              ),\n                              \"function\" == typeof t && t()),\n                            this.Wn(e);\n                        })\n                        .catch((i) => {\n                          _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\"Push unsubscription error: \" + i),\n                            \"function\" == typeof t && t();\n                        }))\n                    : (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"Device already unsubscribed from push.\"),\n                      \"function\" == typeof i && i());\n                })\n                .catch((i) => {\n                  _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].error(\"Error unsubscribing from push: \" + i),\n                    \"function\" == typeof t && t();\n                })\n            : (_shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"Device already unsubscribed from push.\"),\n              \"function\" == typeof i && i());\n        })\n      : this.mn &&\n        (this.An(),\n        _shared_lib_index_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].info(\"Device unsubscribed from push.\"),\n        \"function\" == typeof i && i());\n  }\n}\nna._n = \"Push notifications are not supported in this browser.\";\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AYnJhemUvd2ViLXNkay9zcmMvUHVzaC9wdXNoLW1hbmFnZXIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQW9FO0FBQzNCO0FBQ29DO0FBQ1Y7QUFDM0I7QUFDRDtBQUN3QjtBQUNoRDtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiw0REFBRTtBQUNuQixpQkFBaUIsNERBQUU7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw0REFBQztBQUNkO0FBQ0EsT0FBTztBQUNQO0FBQ0EsUUFBUSw0REFBQztBQUNUO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1IsUUFBUSw0REFBQyxPQUFPLHFFQUFFO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLDREQUFDO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixzREFBSTtBQUNwQjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUFDQSx5QkFBeUI7QUFDekIsdUJBQXVCLDREQUFDO0FBQ3hCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0Esa0JBQWtCLDREQUFDO0FBQ25CO0FBQ0EsaUJBQWlCO0FBQ2pCLGVBQWUsNERBQUM7QUFDaEI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFFBQVEsNERBQUM7QUFDVDtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiL1VzZXJzL2ZhaXp1ci9ob3N0aW5nY29tLWJyYXplLW5leHRqcy9ub2RlX21vZHVsZXMvQGJyYXplL3dlYi1zZGsvc3JjL1B1c2gvcHVzaC1tYW5hZ2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzQXJyYXkgYXMgeiwgaXNFcXVhbCBhcyBpaSB9IGZyb20gXCIuLi91dGlsL2NvZGUtdXRpbHMuanNcIjtcbmltcG9ydCB0aSBmcm9tIFwiLi4vbW9kZWxzL3B1c2gtdG9rZW4uanNcIjtcbmltcG9ydCB7IGxvZ2dlciBhcyBOLCBFbmNvZGluZ1V0aWxzIGFzIGVpIH0gZnJvbSBcIi4uLy4uL3NoYXJlZC1saWIvaW5kZXguanNcIjtcbmltcG9ydCB7IFNUT1JBR0VfS0VZUyBhcyBzIH0gZnJvbSBcIi4uL21hbmFnZXJzL3N0b3JhZ2UtbWFuYWdlci5qc1wiO1xuaW1wb3J0IHsgVXNlciB9IGZyb20gXCIuLi9Vc2VyL2luZGV4LmpzXCI7XG5pbXBvcnQgdnQgZnJvbSBcIi4vdXRpbHMvcHVzaC11dGlscy5qc1wiO1xuaW1wb3J0IHsgZ2V0RXJyb3JNZXNzYWdlIGFzIHNpIH0gZnJvbSBcIi4uL3V0aWwvZXJyb3ItdXRpbHMuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIG5hIHtcbiAgY29uc3RydWN0b3IoaSwgdCwgZSwgcywgciwgbiwgbywgdSwgYSwgaCwgYykge1xuICAgICh0aGlzLm9uID0gaSksXG4gICAgICAodGhpcy51biA9IHQpLFxuICAgICAgKHRoaXMuYW4gPSBlKSxcbiAgICAgICh0aGlzLmhuID0gciksXG4gICAgICAodGhpcy5jbiA9IG4pLFxuICAgICAgKHRoaXMuZm4gPSBvKSxcbiAgICAgICh0aGlzLkIgPSB1KSxcbiAgICAgICh0aGlzLmxuID0gYSksXG4gICAgICAodGhpcy5kbiA9IGgpLFxuICAgICAgKHRoaXMuQyA9IGMpLFxuICAgICAgKHRoaXMub24gPSBpKSxcbiAgICAgICh0aGlzLnVuID0gdCksXG4gICAgICAodGhpcy5hbiA9IGUpLFxuICAgICAgKHRoaXMucG4gPSBzICsgXCIvc2FmYXJpL1wiICsgdCksXG4gICAgICAodGhpcy5obiA9IHIgfHwgXCIvc2VydmljZS13b3JrZXIuanNcIiksXG4gICAgICAodGhpcy5mbiA9IG8pLFxuICAgICAgKHRoaXMuQiA9IHUpLFxuICAgICAgKHRoaXMubG4gPSBhIHx8ICExKSxcbiAgICAgICh0aGlzLmRuID0gaCB8fCAhMSksXG4gICAgICAodGhpcy5DID0gYyksXG4gICAgICAodGhpcy5ibiA9IHZ0LnluKCkpLFxuICAgICAgKHRoaXMubW4gPSB2dC5nbigpKTtcbiAgfVxuICB2bigpIHtcbiAgICByZXR1cm4gdGhpcy5kbjtcbiAgfVxuICB3bihpLCB0LCBlLCBzLCByKSB7XG4gICAgaS51bnN1YnNjcmliZSgpXG4gICAgICAudGhlbigoaSkgPT4ge1xuICAgICAgICBpXG4gICAgICAgICAgPyB0aGlzLmtuKHQsIGUsIHMsIHIpXG4gICAgICAgICAgOiAoTi5lcnJvcihcIkZhaWxlZCB0byB1bnN1YnNjcmliZSBkZXZpY2UgZnJvbSBwdXNoLlwiKSxcbiAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgciAmJiByKCExKSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChpKSA9PiB7XG4gICAgICAgIE4uZXJyb3IoXCJQdXNoIHVuc3Vic2NyaXB0aW9uIGVycm9yOiBcIiArIGkpLFxuICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgciAmJiByKCExKTtcbiAgICAgIH0pO1xuICB9XG4gIFBuKGksIHQsIGUpIHtcbiAgICB2YXIgcztcbiAgICBjb25zdCByID0gKChpKSA9PiB7XG4gICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgaSkgcmV0dXJuIGk7XG4gICAgICBpZiAoMCAhPT0gaS5lbmRwb2ludC5pbmRleE9mKFwiaHR0cHM6Ly9hbmRyb2lkLmdvb2dsZWFwaXMuY29tL2djbS9zZW5kXCIpKVxuICAgICAgICByZXR1cm4gaS5lbmRwb2ludDtcbiAgICAgIGxldCB0ID0gaS5lbmRwb2ludDtcbiAgICAgIGNvbnN0IGUgPSBpO1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgZS5EbiAmJlxuICAgICAgICAgIC0xID09PSBpLmVuZHBvaW50LmluZGV4T2YoZS5EbikgJiZcbiAgICAgICAgICAodCA9IGkuZW5kcG9pbnQgKyBcIi9cIiArIGUuRG4pLFxuICAgICAgICB0XG4gICAgICApO1xuICAgIH0pKGkpO1xuICAgIGxldCBuID0gbnVsbCxcbiAgICAgIG8gPSBudWxsO1xuICAgIGNvbnN0IHUgPSBpO1xuICAgIGlmIChudWxsICE9IHUuZ2V0S2V5KVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaSA9IEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkodS5nZXRLZXkoXCJwMjU2ZGhcIikpKSxcbiAgICAgICAgICB0ID0gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheSh1LmdldEtleShcImF1dGhcIikpKTtcbiAgICAgICAgKG4gPSBidG9hKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgaSkpKSxcbiAgICAgICAgICAobyA9IGJ0b2EoU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCB0KSkpO1xuICAgICAgfSBjYXRjaCAoaSkge1xuICAgICAgICBOLmVycm9yKHNpKGkpKTtcbiAgICAgIH1cbiAgICBjb25zdCBhID0gKChpKSA9PiB7XG4gICAgICBsZXQgdDtcbiAgICAgIHJldHVybiBpLm9wdGlvbnMgJiZcbiAgICAgICAgKHQgPSBpLm9wdGlvbnMuYXBwbGljYXRpb25TZXJ2ZXJLZXkpICYmXG4gICAgICAgIHQuYnl0ZUxlbmd0aCAmJlxuICAgICAgICB0LmJ5dGVMZW5ndGggPiAwXG4gICAgICAgID8gYnRvYShTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkodCkpKSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXCsvZywgXCItXCIpXG4gICAgICAgICAgICAucmVwbGFjZSgvXFwvL2csIFwiX1wiKVxuICAgICAgICA6IG51bGw7XG4gICAgfSkodSk7XG4gICAgbnVsbCA9PT0gKHMgPSB0aGlzLm9uKSB8fCB2b2lkIDAgPT09IHMgfHwgcy5TbihyLCB0LCBuLCBvLCBhKSxcbiAgICAgIHIgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBlICYmIGUociwgbiwgbyk7XG4gIH1cbiAgQW4oKSB7XG4gICAgdmFyIGk7XG4gICAgbnVsbCA9PT0gKGkgPSB0aGlzLm9uKSB8fCB2b2lkIDAgPT09IGkgfHwgaS5qbighMCk7XG4gIH1cbiAgeG4oaSwgdCkge1xuICAgIHZhciBlO1xuICAgIG51bGwgPT09IChlID0gdGhpcy5vbikgfHwgdm9pZCAwID09PSBlIHx8IGUuam4oITEpLFxuICAgICAgTi5pbmZvKGkpLFxuICAgICAgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0ICYmIHQoITEpO1xuICB9XG4gIE5uKGksIHQsIGUsIHMpIHtcbiAgICB2YXIgcjtcbiAgICBpZiAoXCJkZWZhdWx0XCIgPT09IHQucGVybWlzc2lvbilcbiAgICAgIHRyeSB7XG4gICAgICAgIHdpbmRvdy5zYWZhcmkucHVzaE5vdGlmaWNhdGlvbi5yZXF1ZXN0UGVybWlzc2lvbihcbiAgICAgICAgICB0aGlzLnBuLFxuICAgICAgICAgIGksXG4gICAgICAgICAge1xuICAgICAgICAgICAgYXBpX2tleTogdGhpcy51bixcbiAgICAgICAgICAgIGRldmljZV9pZDpcbiAgICAgICAgICAgICAgKG51bGwgPT09IChyID0gdGhpcy5hbikgfHwgdm9pZCAwID09PSByID8gdm9pZCAwIDogci52ZSgpLmlkKSB8fFxuICAgICAgICAgICAgICBcIlwiLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgKHQpID0+IHtcbiAgICAgICAgICAgIFwiZ3JhbnRlZFwiID09PSB0LnBlcm1pc3Npb24gJiZcbiAgICAgICAgICAgICAgdGhpcy5vbiAmJlxuICAgICAgICAgICAgICB0aGlzLm9uLnNldFB1c2hOb3RpZmljYXRpb25TdWJzY3JpcHRpb25UeXBlKFxuICAgICAgICAgICAgICAgIFVzZXIuTm90aWZpY2F0aW9uU3Vic2NyaXB0aW9uVHlwZXMuT1BURURfSU4sXG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIHRoaXMuTm4oaSwgdCwgZSwgcyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICAgIH0gY2F0Y2ggKGkpIHtcbiAgICAgICAgdGhpcy54bihcIkNvdWxkIG5vdCByZXF1ZXN0IHBlcm1pc3Npb24gZm9yIHB1c2g6IFwiICsgaSwgcyk7XG4gICAgICB9XG4gICAgZWxzZVxuICAgICAgXCJkZW5pZWRcIiA9PT0gdC5wZXJtaXNzaW9uXG4gICAgICAgID8gdGhpcy54bihcbiAgICAgICAgICAgIFwiVGhlIHVzZXIgaGFzIGJsb2NrZWQgbm90aWZpY2F0aW9ucyBmcm9tIHRoaXMgc2l0ZSwgb3IgU2FmYXJpIHB1c2ggaXMgbm90IGNvbmZpZ3VyZWQgaW4gdGhlIEJyYXplIGRhc2hib2FyZC5cIixcbiAgICAgICAgICAgIHMsXG4gICAgICAgICAgKVxuICAgICAgICA6IFwiZ3JhbnRlZFwiID09PSB0LnBlcm1pc3Npb24gJiZcbiAgICAgICAgICAoTi5pbmZvKFwiRGV2aWNlIHN1Y2Nlc3NmdWxseSBzdWJzY3JpYmVkIHRvIHB1c2guXCIpLFxuICAgICAgICAgIHRoaXMuUG4odC5kZXZpY2VUb2tlbiwgbmV3IERhdGUoKSwgZSkpO1xuICB9XG4gIHJlcXVlc3RQZXJtaXNzaW9uKGksIHQsIGUpIHtcbiAgICBjb25zdCBzID0gKHMpID0+IHtcbiAgICAgIHN3aXRjaCAocykge1xuICAgICAgICBjYXNlIFwiZ3JhbnRlZFwiOlxuICAgICAgICAgIHJldHVybiB2b2lkIChcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGkgJiYgaSgpKTtcbiAgICAgICAgY2FzZSBcImRlZmF1bHRcIjpcbiAgICAgICAgICByZXR1cm4gdm9pZCAoXCJmdW5jdGlvblwiID09IHR5cGVvZiB0ICYmIHQoKSk7XG4gICAgICAgIGNhc2UgXCJkZW5pZWRcIjpcbiAgICAgICAgICByZXR1cm4gdm9pZCAoXCJmdW5jdGlvblwiID09IHR5cGVvZiBlICYmIGUoKSk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgTi5lcnJvcihcIlJlY2VpdmVkIHVuZXhwZWN0ZWQgcGVybWlzc2lvbiByZXN1bHQgXCIgKyBzKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGxldCByID0gITE7XG4gICAgaWYgKFwiZGVmYXVsdFwiICE9PSB3aW5kb3cuTm90aWZpY2F0aW9uLnBlcm1pc3Npb24pXG4gICAgICBzKE5vdGlmaWNhdGlvbi5wZXJtaXNzaW9uKTtcbiAgICBlbHNlIHtcbiAgICAgIGNvbnN0IGkgPSB3aW5kb3cuTm90aWZpY2F0aW9uLnJlcXVlc3RQZXJtaXNzaW9uKChpKSA9PiB7XG4gICAgICAgIHIgJiYgcyhpKTtcbiAgICAgIH0pO1xuICAgICAgaVxuICAgICAgICA/IGkudGhlbigoaSkgPT4ge1xuICAgICAgICAgICAgcyhpKTtcbiAgICAgICAgICB9KVxuICAgICAgICA6IChyID0gITApO1xuICAgIH1cbiAgfVxuICBrbihpLCB0LCBlLCBzKSB7XG4gICAgY29uc3QgciA9IHsgdXNlclZpc2libGVPbmx5OiAhMCB9O1xuICAgIG51bGwgIT0gdCAmJiAoci5hcHBsaWNhdGlvblNlcnZlcktleSA9IHQpLFxuICAgICAgaS5wdXNoTWFuYWdlclxuICAgICAgICAuc3Vic2NyaWJlKHIpXG4gICAgICAgIC50aGVuKChpKSA9PiB7XG4gICAgICAgICAgTi5pbmZvKFwiRGV2aWNlIHN1Y2Nlc3NmdWxseSBzdWJzY3JpYmVkIHRvIHB1c2guXCIpLFxuICAgICAgICAgICAgdGhpcy5QbihpLCBuZXcgRGF0ZSgpLCBlKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChpKSA9PiB7XG4gICAgICAgICAgdnQuaXNQdXNoQmxvY2tlZCgpXG4gICAgICAgICAgICA/IChOLmluZm8oXCJQZXJtaXNzaW9uIGZvciBwdXNoIG5vdGlmaWNhdGlvbnMgd2FzIGRlbmllZC5cIiksXG4gICAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgcyAmJiBzKCExKSlcbiAgICAgICAgICAgIDogKE4uZXJyb3IoXCJQdXNoIHN1YnNjcmlwdGlvbiBmYWlsZWQ6IFwiICsgaSksXG4gICAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgcyAmJiBzKCEwKSk7XG4gICAgICAgIH0pO1xuICB9XG4gIFVuKCkge1xuICAgIGlmICh0aGlzLmxuKSByZXR1cm4gbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuZ2V0UmVnaXN0cmF0aW9uKHRoaXMuaG4pO1xuICAgIGNvbnN0IGkgPSB0aGlzLmNuID8geyBzY29wZTogdGhpcy5jbiB9IDogdm9pZCAwO1xuICAgIHJldHVybiBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3Rlcih0aGlzLmhuLCBpKS50aGVuKCgpID0+XG4gICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWFkeS50aGVuKFxuICAgICAgICAoaSkgPT4gKFxuICAgICAgICAgIGkgJiZcbiAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgaS51cGRhdGUgJiZcbiAgICAgICAgICAgIGkudXBkYXRlKCkuY2F0Y2goKGkpID0+IHtcbiAgICAgICAgICAgICAgTi5pbmZvKFwiU2VydmljZVdvcmtlciB1cGRhdGUgZmFpbGVkOiBcIiArIGkpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgaVxuICAgICAgICApLFxuICAgICAgKSxcbiAgICApO1xuICB9XG4gIFduKGkpIHtcbiAgICB0aGlzLmxuIHx8XG4gICAgICAoaS51bnJlZ2lzdGVyKCksIE4uaW5mbyhcIlNlcnZpY2Ugd29ya2VyIHN1Y2Nlc3NmdWxseSB1bnJlZ2lzdGVyZWQuXCIpKTtcbiAgfVxuICBzdWJzY3JpYmUoaSwgdCkge1xuICAgIGlmICghdnQuaXNQdXNoU3VwcG9ydGVkKCkpXG4gICAgICByZXR1cm4gTi5pbmZvKG5hLl9uKSwgdm9pZCAoXCJmdW5jdGlvblwiID09IHR5cGVvZiB0ICYmIHQoITEpKTtcbiAgICBpZiAodGhpcy5ibikge1xuICAgICAgaWYgKCF0aGlzLmxuICYmIG51bGwgIT0gd2luZG93LmxvY2F0aW9uKSB7XG4gICAgICAgIGxldCBpID0gdGhpcy5objtcbiAgICAgICAgLTEgPT09IGkuaW5kZXhPZih3aW5kb3cubG9jYXRpb24uaG9zdCkgJiZcbiAgICAgICAgICAoaSA9IHdpbmRvdy5sb2NhdGlvbi5ob3N0ICsgaSksXG4gICAgICAgICAgLTEgPT09IGkuaW5kZXhPZih3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wpICYmXG4gICAgICAgICAgICAoaSA9IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIGkpO1xuICAgICAgfVxuICAgICAgaWYgKHZ0LmlzUHVzaEJsb2NrZWQoKSlcbiAgICAgICAgcmV0dXJuIHZvaWQgdGhpcy54bihcbiAgICAgICAgICBcIk5vdGlmaWNhdGlvbnMgZnJvbSB0aGlzIHNpdGUgYXJlIGJsb2NrZWQuIFRoaXMgbWF5IGJlIGEgdGVtcG9yYXJ5IGVtYmFyZ28gb3IgYSBwZXJtYW5lbnQgZGVuaWFsLlwiLFxuICAgICAgICAgIHQsXG4gICAgICAgICk7XG4gICAgICBpZiAodGhpcy5CICYmICF0aGlzLkIuVG4oKSAmJiAwID09PSB0aGlzLkIuRXQoKSlcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBOLmluZm8oXG4gICAgICAgICAgICBcIldhaXRpbmcgZm9yIFZBUElEIGtleSBmcm9tIHNlcnZlciBjb25maWcgYmVmb3JlIHN1YnNjcmliaW5nIHRvIHB1c2guXCIsXG4gICAgICAgICAgKSxcbiAgICAgICAgICB2b2lkIHRoaXMuQi5JbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZShpLCB0KTtcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgY29uc3QgZSA9ICgpID0+IHtcbiAgICAgICAgICBOLmluZm8oXCJQZXJtaXNzaW9uIGZvciBwdXNoIG5vdGlmaWNhdGlvbnMgd2FzIGRlbmllZC5cIiksXG4gICAgICAgICAgICBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQgJiYgdCghMSk7XG4gICAgICAgIH0sXG4gICAgICAgIHIgPSAoKSA9PiB7XG4gICAgICAgICAgbGV0IGkgPSBcIlBlcm1pc3Npb24gZm9yIHB1c2ggbm90aWZpY2F0aW9ucyB3YXMgaWdub3JlZC5cIjtcbiAgICAgICAgICB2dC5pc1B1c2hCbG9ja2VkKCkgJiZcbiAgICAgICAgICAgIChpICs9XG4gICAgICAgICAgICAgIFwiIFRoZSBicm93c2VyIGhhcyBhdXRvbWF0aWNhbGx5IGJsb2NrZWQgZnVydGhlciBwZXJtaXNzaW9uIHJlcXVlc3RzIGZvciBhIHBlcmlvZCAocHJvYmFibHkgMSB3ZWVrKS5cIiksXG4gICAgICAgICAgICBOLmluZm8oaSksXG4gICAgICAgICAgICBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQgJiYgdCghMCk7XG4gICAgICAgIH0sXG4gICAgICAgIG4gPSB2dC5pc1B1c2hQZXJtaXNzaW9uR3JhbnRlZCgpLFxuICAgICAgICBvID0gKCkgPT4ge1xuICAgICAgICAgICFuICYmXG4gICAgICAgICAgICB0aGlzLm9uICYmXG4gICAgICAgICAgICB0aGlzLm9uLnNldFB1c2hOb3RpZmljYXRpb25TdWJzY3JpcHRpb25UeXBlKFxuICAgICAgICAgICAgICBVc2VyLk5vdGlmaWNhdGlvblN1YnNjcmlwdGlvblR5cGVzLk9QVEVEX0lOLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHRoaXMuVW4oKVxuICAgICAgICAgICAgICAudGhlbigoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChudWxsID09IGUpXG4gICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICBOLmVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgIFwiTm8gc2VydmljZSB3b3JrZXIgcmVnaXN0cmF0aW9uLiBTZXQgdGhlIGBtYW5hZ2VTZXJ2aWNlV29ya2VyRXh0ZXJuYWxseWAgaW5pdGlhbGl6YXRpb24gb3B0aW9uIHRvIGZhbHNlIG9yIGVuc3VyZSB0aGF0IHlvdXIgc2VydmljZSB3b3JrZXIgaXMgcmVnaXN0ZXJlZCBiZWZvcmUgY2FsbGluZyByZWdpc3RlclB1c2guXCIsXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIHZvaWQgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdCAmJiB0KCEwKSlcbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZS5wdXNoTWFuYWdlclxuICAgICAgICAgICAgICAgICAgLmdldFN1YnNjcmlwdGlvbigpXG4gICAgICAgICAgICAgICAgICAudGhlbigocikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbjtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG8gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgKG51bGwgIT1cbiAgICAgICAgICAgICAgICAgICAgICAgIChudWxsID09PSAobiA9IHRoaXMuQikgfHwgdm9pZCAwID09PSBuXG4gICAgICAgICAgICAgICAgICAgICAgICAgID8gdm9pZCAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogbi5UbigpKSAmJiAobyA9IGVpLlZuKHRoaXMuQi5UbigpKSksXG4gICAgICAgICAgICAgICAgICAgICAgcilcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgbGV0IG4sXG4gICAgICAgICAgICAgICAgICAgICAgICB1ID0gbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgIGlmICgodGhpcy5DICYmIChuID0gdGhpcy5DLmZ0KHMuZ3QucW4pKSwgbiAmJiAheihuKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHRpLkVuKG4pLnpuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgPT0gaSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBpc05hTihpLmdldFRpbWUoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgMCA9PT0gaS5nZXRUaW1lKCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKCh1ID0gaSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIChhID0gbmV3IERhdGUodSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNldE1vbnRoKHUuZ2V0TW9udGgoKSArIDYpKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBvICYmXG4gICAgICAgICAgICAgICAgICAgICAgci5vcHRpb25zICYmXG4gICAgICAgICAgICAgICAgICAgICAgci5vcHRpb25zLmFwcGxpY2F0aW9uU2VydmVyS2V5ICYmXG4gICAgICAgICAgICAgICAgICAgICAgci5vcHRpb25zLmFwcGxpY2F0aW9uU2VydmVyS2V5LmJ5dGVMZW5ndGggJiZcbiAgICAgICAgICAgICAgICAgICAgICByLm9wdGlvbnMuYXBwbGljYXRpb25TZXJ2ZXJLZXkuYnl0ZUxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgICAhaWkobywgbmV3IFVpbnQ4QXJyYXkoci5vcHRpb25zLmFwcGxpY2F0aW9uU2VydmVyS2V5KSlcbiAgICAgICAgICAgICAgICAgICAgICAgID8gKHIub3B0aW9ucy5hcHBsaWNhdGlvblNlcnZlcktleS5ieXRlTGVuZ3RoID4gMTJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IE4uaW5mbyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJEZXZpY2Ugd2FzIGFscmVhZHkgc3Vic2NyaWJlZCB0byBwdXNoIHVzaW5nIGEgZGlmZmVyZW50IFZBUElEIHByb3ZpZGVyLCBjcmVhdGluZyBuZXcgc3Vic2NyaXB0aW9uLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogTi5pbmZvKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkF0dGVtcHRpbmcgdG8gdXBncmFkZSBhIGdjbV9zZW5kZXJfaWQtYmFzZWQgcHVzaCByZWdpc3RyYXRpb24gdG8gVkFQSUQgLSBkZXBlbmRpbmcgb24gdGhlIGJyb3dzZXIgdGhpcyBtYXkgb3IgbWF5IG5vdCByZXN1bHQgaW4gdGhlIHNhbWUgZ2NtX3NlbmRlcl9pZC1iYXNlZCBzdWJzY3JpcHRpb24uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnduKHIsIGUsIG8sIGksIHQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiByLmV4cGlyYXRpb25UaW1lICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKHIuZXhwaXJhdGlvblRpbWUpLnZhbHVlT2YoKSA8PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKCkudmFsdWVPZigpXG4gICAgICAgICAgICAgICAgICAgICAgICA/IChOLmluZm8oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQdXNoIHN1YnNjcmlwdGlvbiBpcyBleHBpcmVkLCBjcmVhdGluZyBuZXcgc3Vic2NyaXB0aW9uLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnduKHIsIGUsIG8sIGksIHQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBuICYmIHoobilcbiAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcy53bihyLCBlLCBvLCBpLCB0KVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBudWxsID09IGFcbiAgICAgICAgICAgICAgICAgICAgICAgID8gKE4uaW5mbyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk5vIHB1c2ggc3Vic2NyaXB0aW9uIGNyZWF0aW9uIGRhdGUgZm91bmQsIGNyZWF0aW5nIG5ldyBzdWJzY3JpcHRpb24uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud24ociwgZSwgbywgaSwgdCkpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGEudmFsdWVPZigpIDw9IG5ldyBEYXRlKCkudmFsdWVPZigpXG4gICAgICAgICAgICAgICAgICAgICAgICA/IChOLmluZm8oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQdXNoIHN1YnNjcmlwdGlvbiBvbGRlciB0aGFuIDYgbW9udGhzLCBjcmVhdGluZyBuZXcgc3Vic2NyaXB0aW9uLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnduKHIsIGUsIG8sIGksIHQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAoTi5pbmZvKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiRGV2aWNlIGFscmVhZHkgc3Vic2NyaWJlZCB0byBwdXNoLCBzZW5kaW5nIGV4aXN0aW5nIHN1YnNjcmlwdGlvbiB0byBiYWNrZW5kLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLlBuKHIsIHUsIGkpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHRoaXMua24oZSwgbywgaSwgdCk7XG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgLmNhdGNoKChpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIE4uZXJyb3IoXCJFcnJvciBjaGVja2luZyBjdXJyZW50IHB1c2ggc3Vic2NyaXB0aW9uczogXCIgKyBpKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuY2F0Y2goKGkpID0+IHtcbiAgICAgICAgICAgICAgICBOLmVycm9yKFwiU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gZmFpbGVkOiBcIiArIGkpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgIHRoaXMucmVxdWVzdFBlcm1pc3Npb24obywgciwgZSk7XG4gICAgfSBlbHNlIGlmICh0aGlzLm1uKSB7XG4gICAgICBpZiAobnVsbCA9PSB0aGlzLmZuIHx8IFwiXCIgPT09IHRoaXMuZm4pXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgTi5lcnJvcihcbiAgICAgICAgICAgIFwiWW91IG11c3Qgc3VwcGx5IHRoZSBzYWZhcmlXZWJzaXRlUHVzaElkIGluaXRpYWxpemF0aW9uIG9wdGlvbiBpbiBvcmRlciB0byB1c2UgcmVnaXN0ZXJQdXNoIG9uIFNhZmFyaVwiLFxuICAgICAgICAgICksXG4gICAgICAgICAgdm9pZCAoXCJmdW5jdGlvblwiID09IHR5cGVvZiB0ICYmIHQoITApKVxuICAgICAgICApO1xuICAgICAgY29uc3QgZSA9IHdpbmRvdy5zYWZhcmkucHVzaE5vdGlmaWNhdGlvbi5wZXJtaXNzaW9uKHRoaXMuZm4pO1xuICAgICAgdGhpcy5Obih0aGlzLmZuLCBlLCBpLCB0KTtcbiAgICB9XG4gIH1cbiAgdW5zdWJzY3JpYmUoaSwgdCkge1xuICAgIGlmICghdnQuaXNQdXNoU3VwcG9ydGVkKCkpXG4gICAgICByZXR1cm4gTi5pbmZvKG5hLl9uKSwgdm9pZCAoXCJmdW5jdGlvblwiID09IHR5cGVvZiB0ICYmIHQoKSk7XG4gICAgdGhpcy5iblxuICAgICAgPyBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5nZXRSZWdpc3RyYXRpb24odGhpcy5obikudGhlbigoZSkgPT4ge1xuICAgICAgICAgIGVcbiAgICAgICAgICAgID8gZS5wdXNoTWFuYWdlclxuICAgICAgICAgICAgICAgIC5nZXRTdWJzY3JpcHRpb24oKVxuICAgICAgICAgICAgICAgIC50aGVuKChzKSA9PiB7XG4gICAgICAgICAgICAgICAgICBzXG4gICAgICAgICAgICAgICAgICAgID8gKHRoaXMuQW4oKSxcbiAgICAgICAgICAgICAgICAgICAgICBzXG4gICAgICAgICAgICAgICAgICAgICAgICAudW5zdWJzY3JpYmUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKE4uaW5mbyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJEZXZpY2Ugc3VjY2Vzc2Z1bGx5IHVuc3Vic2NyaWJlZCBmcm9tIHB1c2guXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmdW5jdGlvblwiID09IHR5cGVvZiBpICYmIGkoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IChOLmVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkZhaWxlZCB0byB1bnN1YnNjcmliZSBkZXZpY2UgZnJvbSBwdXNoLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdCAmJiB0KCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuV24oZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIE4uZXJyb3IoXCJQdXNoIHVuc3Vic2NyaXB0aW9uIGVycm9yOiBcIiArIGkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdCAmJiB0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAgICAgOiAoTi5pbmZvKFwiRGV2aWNlIGFscmVhZHkgdW5zdWJzY3JpYmVkIGZyb20gcHVzaC5cIiksXG4gICAgICAgICAgICAgICAgICAgICAgXCJmdW5jdGlvblwiID09IHR5cGVvZiBpICYmIGkoKSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGkpID0+IHtcbiAgICAgICAgICAgICAgICAgIE4uZXJyb3IoXCJFcnJvciB1bnN1YnNjcmliaW5nIGZyb20gcHVzaDogXCIgKyBpKSxcbiAgICAgICAgICAgICAgICAgICAgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0ICYmIHQoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgOiAoTi5pbmZvKFwiRGV2aWNlIGFscmVhZHkgdW5zdWJzY3JpYmVkIGZyb20gcHVzaC5cIiksXG4gICAgICAgICAgICAgIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgaSAmJiBpKCkpO1xuICAgICAgICB9KVxuICAgICAgOiB0aGlzLm1uICYmXG4gICAgICAgICh0aGlzLkFuKCksXG4gICAgICAgIE4uaW5mbyhcIkRldmljZSB1bnN1YnNjcmliZWQgZnJvbSBwdXNoLlwiKSxcbiAgICAgICAgXCJmdW5jdGlvblwiID09IHR5cGVvZiBpICYmIGkoKSk7XG4gIH1cbn1cbm5hLl9uID0gXCJQdXNoIG5vdGlmaWNhdGlvbnMgYXJlIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyLlwiO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@braze/web-sdk/src/Push/push-manager.js\n"));

/***/ })

}]);